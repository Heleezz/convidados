<!-- Modal -->
<div class="modal" id="modal">
  <div class="modal-content">
    <h3>Você é um convidado especial</h3>
    <p>
      Venha passar a noite! 🛏️<br />
      HORARIO: 14h do dia 29/11 até as 15h do dia 30/11<br /><br />
      Não esqueça de trazer:<br />
      - Roupa de piscina 🩱<br />
      - Roupa de dormir confortável 😴<br /><br />
      Confirma que vai dormir aqui?
    </p>
    <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
      <button onclick="confirmarDormir(true)">Sim 😴</button>
      <button onclick="confirmarDormir(false)">Não 👍</button>
    </div>
    <button onclick="fecharModal()">Fechar</button>
  </div>
</div>

<script>
  let ultimoNome = ""; // guarda o nome digitado

  function enviar() {
    let nome = document.getElementById("nome").value.trim();
    let status = document.getElementById("status");
    let container = document.getElementById("container");
    let evento = document.getElementById("evento");

    if (!nome) {
      status.innerText = "Digite um nome.";
      return;
    }

    // guarda o nome para usar depois no modal
    ultimoNome = nome;

    fetch("https://script.google.com/macros/s/AKfycbzSLa5V1wFBO4Hf-1MCa4AdjGF2s8bdjnYm33mwT6-TUk3PiygsPD7qMrABsQw13_D3TQ/exec", {
      method: "POST",
      mode: "no-cors",
      body: JSON.stringify({ nome: nome, dormir: "não informado" })
    });

    status.innerText = "Presença confirmada!";
    document.getElementById("nome").value = "";

    let nomeMinusculo = nome.toLowerCase();

    if (nomesDorminhocos.includes(nomeMinusculo)) {
      setTimeout(() => {
        document.body.style.background = 'linear-gradient(135deg, #d4af37, #ffd700)';
        container.style.background = 'rgba(255, 223, 0, 0.2)';
        evento.style.color = '#666666';
        abrirModal();
      }, 300);
    } else {
      document.body.style.background = 'linear-gradient(135deg, #888888, #cccccc)';
      container.style.background = 'rgba(0, 0, 0, 0.5)';
      evento.style.color = '#ffdb58';
    }
  }

  function confirmarDormir(vaiDormir) {
    // envia novamente a informação com status de dormir
    fetch("https://script.google.com/macros/s/AKfycbzSLa5V1wFBO4Hf-1MCa4AdjGF2s8bdjnYm33mwT6-TUk3PiygsPD7qMrABsQw13_D3TQ/exec", {
      method: "POST",
      mode: "no-cors",
      body: JSON.stringify({ nome: ultimoNome, dormir: vaiDormir ? "sim" : "nao" })
    });

    fecharModal();
    alert("Sua escolha foi registrada: " + (vaiDormir ? "vai dormir 😴" : "não vai dormir 👍"));
  }

  function abrirModal() {
    document.getElementById("modal").classList.add("show");
  }

  function fecharModal() {
    document.getElementById("modal").classList.remove("show");
  }
</script>